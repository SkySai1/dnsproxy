#!dns/bin/python3
import re
from dnslib import DNSRecord
from bitstring import BitArray
from prettytable import PrettyTable
from scapy.layers.l2 import Ether
import hashlib
import hmac

def Decoder(data, short = False):
    #parse = DNSRecord.parse(data)
    #parse.header.opcode=2
    #parse.header
    #data = parse.pack()
    if short is False:
        #HEADER
        print('\nHEADER:')
        id = int.from_bytes(data[:2], 'big')

        row2 = data[2:4]
        row2 = BitArray(row2)

        qr = row2[0:1]
        opcode = row2[1:5]
        aa = row2[5:6]
        tc = row2[6:7]
        rd = row2[7:8]
        ra = row2[8:9]
        z = row2[9:10]
        ad = row2[10:11]
        cd = row2[11:12]
        rcode = row2[12:]

        row3 = BitArray(data[4:6])
        row4 = BitArray(data[6:8])
        row5 = BitArray(data[8:10])
        row6 = BitArray(data[10:12])

        qdcount = row3.int
        ancount = row4.int
        nscount = row5.int
        arcount = row6.int

        
        header = ['Parameter', 'Value']
        t = PrettyTable(header)
        t.add_row(["id", id])
        t.add_row(["qr", qr.bool])
        t.add_row(["opcode", opcode.int])
        t.add_row(["aa", aa.bool])
        t.add_row(["tc", tc.bool])
        t.add_row(["rd", rd.bool])
        t.add_row(["ra", ra.bool])
        t.add_row(["z", z.bool])
        t.add_row(["ad", ad.bool])
        t.add_row(["cd", cd.bool])
        t.add_row(["rcode", rcode.int])
        t.add_row(["qdcount", qdcount])
        t.add_row(["ancount", ancount])
        t.add_row(["nscount", nscount])
        t.add_row(["arcount", arcount])
        if True: print(t)
        start = 12

    else: 
        start = 0
        ancount = 10
    #QUESTION
    print('\nQUESTION SECTION:')

    end, qname = walker(data, start)
    end+=1
    qtype = BitArray(data[end:end+2])
    qclass = BitArray(data[end+2:end+4])
    
    header = ['QNAME', 'QTYPE', 'QCLASS']
    t = PrettyTable(header)
    t.align = 'l'
    qname = '.'.join(qname)
    t.add_row([qname, qtype.int, qclass.int])
    if True:  print(t)

    start = end + 4

    # ANSWER
    print('\nANSWER SECTION:')
    header = ['RNAME', 'RTYPE', 'RCLASS', 'TTL', 'RLENGTH', 'RDATA']
    t = PrettyTable(header)
    t.align = 'l'
    for z in range(ancount):
        end, rname = walker(data,start)
        rtype = BitArray(data[end:end+2])
        rclass = BitArray(data[end+2:end+4])
        ttl = BitArray(data[end+4:end+8])
        rlength = BitArray(data[end+8:end+10])
        start = end+10
        #print(BitArray(data[start:start+rlength.int]).bin)
        if rtype.int in [2,5,6]:
            end, rdata = walker(data, start)
        elif rtype.int == 1:
            rdata = []
            for o in data[start:start+rlength.int]:
                rdata.append(str(o))
        else: rdata = ['EMPTY']
        start+=rlength.int
        #print(BitArray(data[start:start+1]).bin)
        t.add_row(['.'.join(rname), rtype.int, rclass.int, ttl.int, rlength.int, '.'.join(rdata)])
        #break
    print(t)

    print('\n//////////////////////////////\n')

def walker(data, start, name = None):
    if not name:
        name = []
    label = BitArray(data[start:start+1])
    #print(label.bin)
    while label.int != 0:
        if label[:2].bin == '00':
            oct = label.int
            end = start + oct + 1
            tempname = str(data[start:end])
            name.append(re.sub(r'^b\'\\x[0-9]+','',tempname).rstrip('\''))
            #print(name)
            label = BitArray(data[end:end+1])
            start = end
        elif label[:2].bin == '11':
            point = BitArray(data[start:start+2])
            point = point[2:]
            _, name = walker(data, point.int, name)
            start = start + 2
            break
        
    return start, name
    dtype = BitArray(data[start:start+2])
    dclass = BitArray(data[start+2:start+4])
    if not responce:
        return start+5, name, dtype, dclass
    
if __name__ == '__main__':
    qU =b'V\x17\x00\x00\x00\x01\x00\x00\x00\x00\x00\x01\x07example\x02su\x00\x00\x06\x00\x01\x00\x00)\x08\x00\x00\x00\x00\x00\x00\x04\x00\t\x00\x00'
    rU = b'V\x17\x84\x80\x00\x01\x00\x01\x00\x01\x00\x02\x07example\x02su\x00\x00\x06\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x006\x02ns\x07example\x02ru\x00\x07skyneak\x05gmail\x03com\x00x\x85\xc00\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x05\x02ns\xc0\x0c\xc0j\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x7f\x00\x00\x01\x00\x00)\x10\x00\x00\x00\x00\x00\x00\x08\x00\t\x00\x04\x006\xee\x80'
    rT = b'\x00\xb3\xa4\x18\x84\x80\x00\x01\x00\x05\x00\x00\x00\x00\x07example\x02su\x00\x00\xfc\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x006\x02ns\x07example\x02ru\x00\x07skyneak\x05gmail\x03com\x00x\x85\xc00\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x05\x02ns\xc0\x0c\xc0\x0c\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0j\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x7f\x00\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x00\x18\xc0(\xc07x\x85\xc00\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80'
    rTc = b'\xa4\x18\x84\x80\x00\x01\x00\x05\x00\x00\x00\x00\x07example\x02su\x00\x00\xfc\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x006\x02ns\x07example\x02ru\x00\x07skyneak\x05gmail\x03com\x00x\x85\xc00\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x05\x02ns\xc0\x0c\xc0\x0c\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0j\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x7f\x00\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x00\x18\xc0(\xc07x\x85\xc00\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80'

    tinirog = b'\x08\xbaXM\x84\x80\x00\x01\x00@\x00\x00\x00\x00\x07tinirog\x02ru\x00\x00\xfc\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x00)\xc0\x0c\x07skyneak\x05gmail\x03com\x00x\x95.)\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00#"v=spf1 a mx ip4:95.165.134.11 ~all\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00&%yandex-verification: 45b5181b1eeac88b\xc0\x0c\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0\x0c\x00\x0f\x00\x01\x00\x01Q\x80\x00\t\x00\n\x04mail\xc0\x0c\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x06\x03ns1\xc0\x0c\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x06\x03ns2\xc0\x0c\x01*\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00\x05\x04test\x0f_acme-challenge\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00,+7AlBvqMEzbZM72Gp1jqkOoG_DXvXbHJ5huaV0tzDLkY\xc1\x0e\x00\x10\x00\x01\x00\x01Q\x80\x00,+ojOgxloFT_x4gW4OIVzssT4FOPQKqlx8huSdDSXj7oU\x06_dmarc\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00ZYv=DMARC1; p=none; rua=mailto:trash@tinirog.ru; ruf=mailto:trash@tinirog.ru; fo=1; pct=100\x01t\n_domainkey\x07tinirog\x02ru\x00\x00\x10\x00\x01\x00\x01Q\x80\x01\x1b\x19v=DKIM1; h=sha256; k=rsa;/p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAo/m1kEaX2oKub0ftb3OwA+owXcYX0O/30ZaHnNzQKhh7MSkNk/INP3Zy7utdXhzAum2+OC7DXum4bQt3hS0GEu5/CHc7VAR4V/OWERq9ZgZ9g9U5q8IkRS9myK2U4a8+0I7uppzDPfGlYsosp@3Y1jUDk40jA55lKsENZpAXE33JSA1hS56r/jhLeYtvAZ2exEGqLAtDLliNhJdG9t\x01a\x03dns\x07tinirog\x02ru\x00\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04-T\x9b\x04\xc39\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04MI\x84 \xc39\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04_\xa5\x86\x0b\x03bcn\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\n\x07nothing\xc0\x0c\x04bcn2\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x06\x03bcn\xc0\x0c\x02cn\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc39\x03cn2\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xaa\x03cn3\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xbb\x03cn4\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xcd\x01h\xc3;\x00\r\x00\x01\x00\x00\x00<\x00\x0f\x07aarch64\x06ubuntu\x02mx\xc3;\x00\x0f\x00\x01\x00\x00\x00<\x00\x04\x00\n\xc0\xd0\xc4\x0e\x00\x0f\x00\x01\x00\x00\x00<\x00\x16\x00\x0f\x04mail\x02ru\x07tinirog\x02ru\x00\x04_dns\x04_tcp\x03srv\x03dns\x07tinirog\x02ru\x00\x00!\x00\x01\x00\x00\x00<\x00\x12\x00\n\x00\x05\x005\x07tinirog\x02ru\x00\xc4C\x00!\x00\x01\x00\x00\x00<\x00\x14\x00\x14\x00\x05\x005\x01n\x07tinirog\x02ru\x00\xc4C\x00!\x00\x01\x00\x00\x00<\x00\x15\x00\x1e\x00\x05\x005\x02t1\x07tinirog\x02ru\x00\x03txt\xc3;\x00\x10\x00\x01\x00\x00\x00(\x00\x12\x11YOU ARE A PIRATE!\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00\x12\x11You are a pirate!\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00\x18\x17Yar har, fiddle di dee,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00! Being a pirate is alright to be,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00*)Do what you want \'cause a pirate is free,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00+*Do what you want, \'cause a pirate is free!\x05flask\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc5\xbc\x00\x10\x00\x01\x00\x01Q\x80\x00,+YhiO-KIy4D2vrpVmyOX39yAtbOvWfXLxCp_tU6IS19Y\tgosuslugi\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x02in\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x04kris\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x01\x01\x01\x01\xc6E\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x02\x02\x02\x03\xc6E\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x02\x02\x02\x06\xc0\xd0\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x02mc\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc4\x8f\x00\x01\x00\x01\x00\x01Q\x80\x00\x04MI\x84 \x01*\xc4\x8f\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\x8f\x05named\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\t\x03dns\x03tng\x00\x02nd\xc4\xb2\x00\x02\x00\x01\x00\x01Q\x80\x00\x02\xc4\xaf\xc0\xe3\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0\xf5\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x03pma\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x05stats\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc7\x1d\x00\x10\x00\x01\x00\x01Q\x80\x00,+kL0pRHnJMuEyXkY9hcoNJMve6XrKLjygKaDge0ILAfg\x01t\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc4\xaf\x00\x01\x00\x01\x00\x01Q\x80\x00\x04-T\x9b\x04\x04*ssh\xc4\xaf\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xaf\x07test-ns\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x05test2\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x03ttl\xc4\xb2\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc4\xb2\x05wmail\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x04work\xc4\xb2\x00\x02\x00\x01\x00\x01Q\x80\x00\x02\xc7\xb0\x02wp\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x03www\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x01z\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc8<\x00\x10\x00\x01\x00\x01Q\x80\x00,+u-fYEGI4VB3oJRKsHKXtR37k1g8hpmIFYKeD21mzaeo\xc4\xb2\x00\x06\x00\x01\x00\x01Q\x80\x00\x18\xc4\xb2\xc0*x\x95.)\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80'
    p1tinirog = b'\x08\xba$\xdd\x84\x80\x00\x01\x00@\x00\x00\x00\x00\x07tinirog\x02ru\x00\x00\xfc\x00\x01\xc0\x0c\x00\x06\x00\x01\x00\x01Q\x80\x00)\xc0\x0c\x07skyneak\x05gmail\x03com\x00x\x95.)\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00#"v=spf1 a mx ip4:95.165.134.11 ~all\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00&%yandex-verification: 45b5181b1eeac88b\xc0\x0c\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0\x0c\x00\x0f\x00\x01\x00\x01Q\x80\x00\t\x00\n\x04mail\xc0\x0c\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x06\x03ns1\xc0\x0c\xc0\x0c\x00\x02\x00\x01\x00\x01Q\x80\x00\x06\x03ns2\xc0\x0c\x01*\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00\x05\x04test\x0f_acme-challenge\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00,+7AlBvqMEzbZM72Gp1jqkOoG_DXvXbHJ5huaV0tzDLkY\xc1\x0e\x00\x10\x00\x01\x00\x01Q\x80\x00,+ojOgxloFT_x4gW4OIVzssT4FOPQKqlx8huSdDSXj7oU\x06_dmarc\xc0\x0c\x00\x10\x00\x01\x00\x01Q\x80\x00ZYv=DMARC1; p=none; rua=mailto:trash@tinirog.ru; ruf=mailto:trash@tinirog.ru; fo=1; pct=100\x01t\n_domainkey\x07tinirog\x02ru\x00\x00\x10\x00\x01\x00\x01Q\x80\x01\x1b\x19v=DKIM1; h=sha256; k=rsa;/p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAo/m1kEaX2oKub0ftb3OwA+owXcYX0O/30ZaHnNzQKhh7MSkNk/INP3Zy7utdXhzAum2+OC7DXum4bQt3hS0GEu5/CHc7VAR4V/OWERq9ZgZ9g9U5q8IkRS9myK2U4a8+0I7uppzDPfGlYsosp@3Y1jUDk40jA55lKsENZpAXE33JSA1hS56r/jhLeYtvAZ2exEGqLAtDLliNhJdG9t\x01a\x03dns\x07tinirog\x02ru\x00\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04-T\x9b\x04\xc39\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04MI\x84 \xc39\x00\x01\x00\x01\x00\x00\x00\x14\x00\x04_\xa5\x86\x0b\x03bcn\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\n\x07nothing\xc0\x0c\x04bcn2\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x06\x03bcn\xc0\x0c\x02cn\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc39\x03cn2\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xaa\x03cn3\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xbb\x03cn4\xc3;\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc3\xcd\x01h\xc3;\x00\r\x00\x01\x00\x00\x00<\x00\x0f\x07aarch64\x06ubuntu\x02mx\xc3;\x00\x0f\x00\x01\x00\x00\x00<\x00\x04\x00\n\xc0\xd0\xc4\x0e\x00\x0f\x00\x01\x00\x00\x00<\x00\x16\x00\x0f\x04mail\x02ru\x07tinirog\x02ru\x00\x04_dns\x04_tcp\x03srv\x03dns\x07tinirog\x02ru\x00\x00!\x00\x01\x00\x00\x00<\x00\x12\x00\n\x00\x05\x005\x07tinirog\x02ru\x00\xc4C\x00!\x00\x01\x00\x00\x00<\x00\x14\x00\x14\x00\x05\x005\x01n\x07tinirog\x02ru\x00\xc4C\x00!\x00\x01\x00\x00\x00<\x00\x15\x00\x1e\x00\x05\x005\x02t1\x07tinirog\x02ru\x00\x03txt\xc3;\x00\x10\x00\x01\x00\x00\x00(\x00\x12\x11YOU ARE A PIRATE!\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00\x12\x11You are a pirate!\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00\x18\x17Yar har, fiddle di dee,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00! Being a pirate is alright to be,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00*)Do what you want \'cause a pirate is free,\xc4\xbe\x00\x10\x00\x01\x00\x00\x00(\x00+*Do what you want, \'c'
    p2tinirog = b'ause a pirate is free!\x05flask\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc5\xbc\x00\x10\x00\x01\x00\x01Q\x80\x00,+YhiO-KIy4D2vrpVmyOX39yAtbOvWfXLxCp_tU6IS19Y\tgosuslugi\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x02in\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x04kris\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x01\x01\x01\x01\xc6E\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x02\x02\x02\x03\xc6E\x00\x01\x00\x01\x00\x01Q\x80\x00\x04\x02\x02\x02\x06\xc0\xd0\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x02mc\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc4\x8f\x00\x01\x00\x01\x00\x01Q\x80\x00\x04MI\x84 \x01*\xc4\x8f\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\x8f\x05named\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\t\x03dns\x03tng\x00\x02nd\xc4\xb2\x00\x02\x00\x01\x00\x01Q\x80\x00\x02\xc4\xaf\xc0\xe3\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc0\xf5\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x03pma\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x05stats\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc7\x1d\x00\x10\x00\x01\x00\x01Q\x80\x00,+kL0pRHnJMuEyXkY9hcoNJMve6XrKLjygKaDge0ILAfg\x01t\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\xc4\xaf\x00\x01\x00\x01\x00\x01Q\x80\x00\x04-T\x9b\x04\x04*ssh\xc4\xaf\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xaf\x07test-ns\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x05test2\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x03ttl\xc4\xb2\x00\x05\x00\x01\x00\x00\x00\x14\x00\x02\xc4\xb2\x05wmail\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x04work\xc4\xb2\x00\x02\x00\x01\x00\x01Q\x80\x00\x02\xc7\xb0\x02wp\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x03www\xc4\xb2\x00\x05\x00\x01\x00\x01Q\x80\x00\x02\xc4\xb2\x01z\xc4\xb2\x00\x01\x00\x01\x00\x01Q\x80\x00\x04_\xa5\x86\x0b\x0f_acme-challenge\xc8<\x00\x10\x00\x01\x00\x01Q\x80\x00,+u-fYEGI4VB3oJRKsHKXtR37k1g8hpmIFYKeD21mzaeo\xc4\xb2\x00\x06\x00\x01\x00\x01Q\x80\x00\x18\xc4\xb2\xc0*x\x95.)\x00\x00\x0e\x10\x00\x00\x02X\x006\xee\x80\x00\x01Q\x80'
    c = Ether(qU)
    origin = "0B686D61632D73686132353600000064529574012C0020C3B762FE06FCD243C94149A5AA2134C93051D7367BC5C362E970CF252DE353AA0DF800000000"
    key = '302faOimRL7J6y7AfKWTwq/346PEynIqU4n/muJCPbs='
    word = 'tinirog-waramik'
    h = hmac.new(word.encode(),key.encode(),hashlib.sha256)
    print(h.hexdigest())
    #print(DNSRecord.parse(p1tinirog[2:]+p2tinirog))